# phi

## Write-up
In the RSA cryptosystem, we have the following relationship between the public exponent `e` and the private exponent `d`:
<p align="center">
  <img src="https://latex.codecogs.com/gif.latex?%5Cbg_white%20e.d%20%5Cequiv%201%5C%3B%28mod%20%5C%3B%20%5Cvarphi%20%28n%29%29" alt="RSA equation 1">
</p>

Which can be rearranged as:
<p align="center">
  <img src="https://latex.codecogs.com/gif.latex?%5Cbg_white%20d%20%5Cequiv%20e%5E%7B-1%7D%5C%3B%28mod%20%5C%3B%20%5Cvarphi%20%28n%29%29" alt="RSA equation (rearranged)">
</p>

The private exponent `d`  is the multiplicative inverse of `e` modulo `Ï†(n)`, we can thus use the [extended euclidean algorithm](https://en.wikipedia.org/wiki/Extended_Euclidean_algorithm) to compute `d`.

```python
#!/usr/bin/python3
from Crypto.Util.number import inverse, long_to_bytes

n = 603691441473732465698285164821849947808842560312030773366774147205646417420342579455757126282536638998441929683961788591036575385467008167356283085177958800608456800248155884176944373348711152558017898747800185979046204275811814630916258301741186389344687060605696548745488345018440514601177221353238702343754703302498070251336424851128195564120206561448075267785884775510119096851247008779133382005070735878515291862689021905906433868234427607068375774126705133816927950027518830946147173618167992413792240844075127242299915379336290275527031440059289100107539477967925858124375797657133045470869271343854570451544362616626137293575040045179464199616430796311138143945562021848365571008318541983418733672596587134887181631755984250310752833860893627719482300660932944573029838719778809280249557737433269682678366871467408426817468506423823067074283244977861276829928913413502015758533094976155983528256011787497585699492124606744158750212400477535450844524753371138124090405483778143425954008813788917564664365099456558862965599836365939353570523402815816664581267138972079222038071391422151803794280269654020581998050837643440277508395305082331998755107006148428221798963334591522927555820180042767498118671899488967296118703912411
phi = 603691441473732465698285164821849947808842560312030773366774147205646417420342579455757126282536638998441929683961788591036575385467008167356283085177958800608456800248155884176944373348711152558017898747800185979046204275811814630916258301741186389344687060605696548745488345018440514601177221353238702343754703302498070251336424851128195564120206561448075267785884775510119096851247008779133382005070735878515291862689021905906433868234427607068375774126705133816927950027518830946147173618167992413792240844075127242299915379336290275527031440059289100107539477967925858124375797657133045470869271343854570451544312522969255902099322977417287866169018915077702343636591931294841334014798446986088413059569651703492634582417264173963770440391127503940977437723626528750720740003327768873035236511737967363197078050928007982643492448394589395267492050851760339579789123639574372510527673888520076036905298082377912640137434532533258402927641414016474896150815209280876660024628178524681083292042529656229417741491463262449571473996974896486459703119855335874722870910568889100681657778314849964680476571815036930063869650978289210281091602417698287624312379323398508757825834468473654683615340724063709321816518231906205029302733672
c = 289802908267296881955894077449966196210796280949611213346038436573356038035844652498540238503722421654390767707639120442412938984257404582126169275522855615263646727346980495771193870132563384404746031578426428825247157407646348370382751145395659808844470328829097184355060959173666608625376930405863322805674797645888985670505960001759992354066305609696642002146367927422758468012304302236323892311188349375921375372280117817360868842333882280613165107321479948955724513724291873799984020909753726011795424438303000161074144388325512070399235168459385180906152534528453496685539377940796394385564928738113358453151292615590550145093388728235993737453052717766371903397428775516941611720296535984604693770482280567855772615832168878961498963755664284016130220522478038516062448434189014494569222676563154682586048387671456375712506375044951350659350270330310337837489229133173091228464842541419261891226279069767786886387022929114175733544215807574011911382127917752380447046813357015192047525030338431706582097642899971814807306810229012294754697561456665447129903422516604951441077909265951541887957006795815314583037817896301060778719868247824221177103953159782961426678742526302891552135829978485624429091364897527891402451103172
e = 65537

d = inverse(e, phi)
flag = long_to_bytes(pow(c, d, n))

print(flag.decode())
```

## Flag

`shellmates{Ph1_Must_b3_K3pT_s3Cr3t}`
